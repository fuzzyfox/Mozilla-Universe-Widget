if(typeof console=="undefined"){var console={};console.log=console.info=console.error=console.dir=function(){};}if(typeof mozillaUniverse=="undefined"){var mozillaUniverse={};mozillaUniverse.exists=false;}else{mozillaUniverse.exists=true;}mozillaUniverse=function(a,b){if(!mozillaUniverse.exists){mozillaUniverse.exists=true;if((typeof jQuery!="undefined")&&(jQuery().jquery!="1.4.2")){console.log("jQuery has been found but is not known to work with the Mozilla Universe Widget\r\nNow replacing with jQuery 1.4.2");$=undefined;jQuery=undefined;delete $,jQuery;mozillaUniverse.getScript("http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js");a.noConflict=false;}else{if(typeof jQuery=="undefined"){mozillaUniverse.getScript("http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js");a.noConflict=true;}}if(/MSIE \d+\.\d+/.test(navigator.userAgent)){mozillaUniverse.getScript("http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/js/excanvas.js");}mozillaUniverse.getScript("http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/js/jit.min.js");mozillaUniverse.tryReady(0,a);}else{console.log("you appear to be attempting to load the mozilla universe widget twice... you cannot load this twice, but don' worry, we just wont let you :D");}if(typeof b!="undefined"){b();}};mozillaUniverse.getScript=function(b){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",b);document.getElementsByTagName("body")[0].appendChild(a);};mozillaUniverse.tryReady=function(b,a){if(typeof jQuery=="undefined"){if(b<=5000){setTimeout("mozillaUniverse.tryReady("+(b+200)+", "+JSON.stringify(a)+")",200);}else{console.log("Woops! jQuery wont load... this means the widget will not load, and if you had an older verison of jQuery on the page, well it wont be working either... sorry we borked your page :(");}}else{if(a.noConflict){jQuery.noConflict();}mozillaUniverse.widget(a);}};mozillaUniverse.widget=function(e){var c={widget:{theme:"default",parent:"body",footnote:'This map uses the HTML5 <a href="https://developer.mozilla.org/en/HTML/Canvas">canvas</a> tag, CSS3 attributes, and is powered by the open-source <a href="http://thejit.org/">JavaScript InfoVis Toolkit</a>.'},map:{maxWidth:400,maxHeight:400,defaultNode:"mozilla",dataUrl:"http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/js/data.json"}};e.widget=jQuery.extend(c.widget,e.widget);e.map=jQuery.extend(c.map,e.map);jQuery("head").append('<link rel="stylesheet" href="http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/css/universe.css" type="text/css">');var a=jQuery('<div class="mozilla-universe-widget"></div>').addClass(e.widget.theme);var d=jQuery('<div class="mozilla-universe-overlay"><div class="mozilla-universe-map"><div id="universe-graph"><div id="universe-panel"></div></div></div></div>');var b=jQuery('<p id="mozilla-universe-footnote">'+e.widget.footnote+"</p>");d.append(b);a.append(d);switch(e.widget.theme){case"tab":a.append('<div id="mozilla-universe-toggle"><div id="mozilla-universe-tab"><img src="http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/img/mozilla-universe-tab.png" alt="mozilla"></div></div>');jQuery(e.widget.parent).append(a);a.show();jQuery("#mozilla-universe-tab").click(function(){jQuery(".mozilla-universe-overlay").slideToggle("slow");});jQuery("[rel=mozilla-universe]").click(function(){jQuery(".mozilla-universe-overlay").slideToggle("slow");return false;});break;case"footer":jQuery(e.widget.parent).prepend(a);jQuery(".mozilla-universe-overlay").append('<img id="mozilla-universe-close" src="http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/img/mozillaUniverseWidget-close.png" alt="close">');jQuery("[rel=mozilla-universe]").click(function(){a.slideToggle("slow");return false;});jQuery("#mozilla-universe-close").click(function(){a.slideToggle("slow");});break;case"embed":jQuery(e.widget.parent).html(a);jQuery(".mozilla-universe-overlay").width((e.map.maxWidth+200));a.show();break;default:jQuery(e.widget.parent).append(a);jQuery(".mozilla-universe-overlay").append('<img id="mozilla-universe-close" src="http://fuzzyfox.github.com/Mozilla-Universe-Widget/assets/img/mozillaUniverseWidget-close.png" alt="close">');jQuery("[rel=mozilla-universe]").click(function(){a.fadeIn("slow",function(){var g=jQuery(".mozilla-universe-overlay").height()+20;var f=(document.all)?((document.body.offsetHeight-g)/2):((window.innerHeight-g)/2);jQuery(".mozilla-universe-overlay").css("margin-top",f+"px");jQuery("#mozilla-universe-close").click(function(){a.fadeOut("slow");});a.click(function(){a.fadeOut("slow");});jQuery(".mozilla-universe-overlay").click(function(h){h.stopPropagation();});});return false;});break;}mozillaUniverse.map(e.map,function(){var f=location.href.split("#")[0];location.href=f+"#"+e.map.defaultNode;});};mozillaUniverse.map=function(a,d){if(typeof c=="undefined"){var c={};}if(typeof c.mozilla=="undefined"){c.mozilla={};}function b(g,f,e){if(g.addEventListener){g.addEventListener(f,e,false);}else{g.attachEvent("on"+f,e);}}c.mozilla.SiteMap={$graph:jQuery("#universe-graph"),$panel:jQuery("#universe-panel"),data:{},selectedNode:null,rootNode:null,tip:{blocked:false,nodeId:null,hoverTimer:null,fadeTimer:null},TIP_SHOW_PERIOD:200,TIP_HIDE_PERIOD:500,TIP_HOVER_PERIOD:200,TIP_FADE_PERIOD:400,LOCATION_INTERVAL:0.2,MOVE_PERIOD:750,getWidth:function(){return Math.max(a.maxWidth,c.mozilla.SiteMap.$graph.width()-200);},getHeight:function(){if(document.all){return Math.max(a.maxHeight,document.body.offsetHeight-200);}else{return Math.max(a.maxHeight,window.innerHeight-200);}},defaultConfig:{hideLabels:false,levelDistance:250,Node:{overridable:true,type:"circle",color:"#ddd",dim:5},Edge:{overridable:true,lineWidth:2,color:"#666"},onBeforeCompute:function(e){c.mozilla.SiteMap.hideTip();},onAfterCompute:function(){},onBeforePlotNode:function(e){if(e._depth<2){e.data.$color="#999";}else{e.data.$color="#ddd";}},onAfterPlotNode:function(e){c.mozilla.SiteMap.$graph.trigger("cm:graph:ready");},onBeforePlotLine:function(g){var f=g.nodeFrom,e=g.nodeTo;if(typeof f.data.$type=="undefined"){g.nodeFrom.data.$type="circle";}if(typeof e.data.$type=="undefined"){g.nodeTo.data.$type="circle";}if(typeof f.data.$tt=="undefined"){g.nodeFrom.data.$tt=f.data.$type;}if(typeof e.data.$tt=="undefined"){g.nodeTo.data.$tt=e.data.$type;}if(Math.abs(f._depth-e._depth)==1&&(f._depth==0||e._depth==0)){g.data.$color="#999";g.data.$lineWidth=2;}else{g.data.$color="#ddd";g.data.$lineWidth=1;}},onCreateLabel:function(f,e){f.innerHTML="<h5>"+e.name+"</h5>";f.id="node-"+f.id;jQuery(f).mouseover(function(g){if(c.mozilla.SiteMap.tip.blocked){return;}if(c.mozilla.SiteMap.tip.fadeTimer){clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.fadeTimer=null;}clearTimeout(c.mozilla.SiteMap.tip.hoverTimer);c.mozilla.SiteMap.tip.hoverTimer=null;c.mozilla.SiteMap.tip.hoverTimer=setTimeout(function(){clearTimeout(c.mozilla.SiteMap.tip.hoverTimer);c.mozilla.SiteMap.tip.hoverTimer=null;c.mozilla.SiteMap.showTip(e);},c.mozilla.SiteMap.TIP_HOVER_PERIOD);}).mouseout(function(g){if(c.mozilla.SiteMap.tip.blocked){return;}if(c.mozilla.SiteMap.tip.hoverTimer){clearTimeout(c.mozilla.SiteMap.tip.hoverTimer);c.mozilla.SiteMap.tip.hoverTimer=null;}clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.tip.fadeTimer=null;c.mozilla.SiteMap.tip.fadeTimer=setTimeout(function(){clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.tip.fadeTimer=null;c.mozilla.SiteMap.hideTip();},c.mozilla.SiteMap.TIP_FADE_PERIOD);}).click(function(g){c.mozilla.SiteMap.selectNode(e);});},onPlaceLabel:function(k,g){var i=jQuery(k);var f=k.style;if(typeof g.data.icon!=="undefined"&&k.getElementsByTagName("img").length===0){i.addClass("imaged").prepend('<span class="logo"><img src="'+g.data.icon+'" alt="'+g.name+'" /></span>');g.data.$dim=0;}k.className=k.className.replace(/([^-])level-[0-9]+/,"$1");i.addClass("level-"+g.data.treeDepth);k.className=k.className.replace(/visible-level-[0-9]+/,"");var j=(g.data.important)?Math.max(0,g._depth-1):g._depth;i.addClass("visible-level-"+j);var h=parseInt(f.left);var e=k.offsetWidth;f.left=(h-e/2)+"px";}},selectNode:function(i){if(c.mozilla.SiteMap.selectedNode!==i){var j=location.href.split("#")[0];location.href=j+"#"+i.id;c.mozilla.SiteMap.selectedNode=i;var h,f,k;var g=jQuery("#node-"+i.id);var e=0;jQuery.each(i.adjacencies,function(m,l){e++;k=m;if(e>1){return false;}});jQuery(".selected").removeClass("selected");g.addClass("selected");f=(e===1)?k:i.id;h=jQuery("#node-"+f);if(!h.hasClass("centered")){jQuery(".centered").removeClass("centered");h.addClass("centered");c.mozilla.SiteMap.hypertree.onClick(f);}c.mozilla.SiteMap.showTip(i);}},showTip:function(f,k){if(c.mozilla.SiteMap.hypertree.busy){return;}if(c.mozilla.SiteMap.tip.nodeId==f.id){return;}if(k){c.mozilla.SiteMap.tip.blocked=true;}c.mozilla.SiteMap.tip.nodeId=f.id;var l=document.getElementById("node-"+f.id);var j=parseInt(l.style.left);var i=parseInt(l.style.top);c.mozilla.SiteMap.$panel.stop();c.mozilla.SiteMap.$panel.css("display","block");var g="";if(typeof f.data.image!=="undefined"){g+='<img src="'+f.data.image+'" alt="'+f.name+'" />';}g+="<h3>"+f.name+"</h3>";if(typeof f.data.url!=="undefined"){g+='<a href="'+f.data.url+'" class="panel-link" target="_blank">'+f.data.url.replace("http://","")+"</a>";}if(typeof f.data.desc!=="undefined"){g+="<p>"+f.data.desc.join("</p><p>")+"</p>";}c.mozilla.SiteMap.$panel.html(g);var e=c.mozilla.SiteMap.$panel.height();c.mozilla.SiteMap.$panel.animate({opacity:1,left:(j-3),top:(i-e-26)},c.mozilla.SiteMap.TIP_SHOW_PERIOD,function(){c.mozilla.SiteMap.tip.blocked=false;});},hideTip:function(e){c.mozilla.SiteMap.tip.nodeId=null;c.mozilla.SiteMap.$panel.stop();c.mozilla.SiteMap.$panel.animate({opacity:0},c.mozilla.SiteMap.TIP_HIDE_PERIOD,function(){c.mozilla.SiteMap.$panel.css("display","none");});},loadData:function(){jQuery.ajax({url:c.mozilla.SiteMap.dataUrl,jsonpCallback:"mapData",dataType:"jsonp",success:function(e){c.mozilla.SiteMap.data=c.mozilla.SiteMap.cleanData(e);c.mozilla.SiteMap.$graph.trigger("cm:data:ready");}});},cleanData:function(f){var e=function(h,j){h.data.treeDepth=j;if(h.children&&h.children instanceof Array){for(var g=0;g<h.children.length;g++){e(h.children[g],j+1);}}};e(f,0);return f;},loadGraph:function(){var e=c.mozilla.SiteMap.getWidth();var f=c.mozilla.SiteMap.getHeight();var i=Math.min(e,f);c.mozilla.SiteMap.$graph.css("height",i);c.mozilla.SiteMap.$graph.css("width",i);c.mozilla.SiteMap.canvas=new Canvas("universe-canvas",{injectInto:"universe-graph",width:i,height:i});c.mozilla.SiteMap.hypertree=new Hypertree(c.mozilla.SiteMap.canvas,c.mozilla.SiteMap.config);c.mozilla.SiteMap.hypertree.fx.config.duration=c.mozilla.SiteMap.MOVE_PERIOD;c.mozilla.SiteMap.hypertree.loadJSON(c.mozilla.SiteMap.data);c.mozilla.SiteMap.hypertree.refresh();c.mozilla.SiteMap.hypertree.controller.onAfterCompute();c.mozilla.SiteMap.$graph.trigger("cm:graph:ready");var j,g;for(j in c.mozilla.SiteMap.hypertree.graph.nodes){g=c.mozilla.SiteMap.hypertree.graph.nodes[j];if(g&&g.data.treeDepth==0){c.mozilla.SiteMap.rootNode=g;break;}}if(c.mozilla.SiteMap.rootNode){jQuery("#node-"+c.mozilla.SiteMap.rootNode.id).addClass("selected");c.mozilla.SiteMap.selectedNode=c.mozilla.SiteMap.rootNode;}},reset:function(){if(typeof c.mozilla.SiteMap.hypertree!=="undefined"){c.mozilla.SiteMap.hypertree.fx.clearLabels();}c.mozilla.SiteMap.config=c.mozilla.SiteMap.defaultConfig;c.mozilla.SiteMap.config.levelDistance=Math.max(150,c.mozilla.SiteMap.getHeight()/6);},initPanel:function(){c.mozilla.SiteMap.$panel.mouseover(function(f){if(c.mozilla.SiteMap.tip.fadeTimer){clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.fadeTimer=null;}if(c.mozilla.SiteMap.tip.hoverTimer){clearTimeout(c.mozilla.SiteMap.tip.hoverTimer);c.mozilla.SiteMap.tip.hoverTimer=null;}}).mouseout(function(f){if(c.mozilla.SiteMap.tip.blocked){return;}if(c.mozilla.SiteMap.tip.hoverTimer){clearTimeout(c.mozilla.SiteMap.tip.hoverTimer);c.mozilla.SiteMap.tip.hoverTimer=null;}if(c.mozilla.SiteMap.tip.fadeTimer){clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.tip.fadeTimer=null;}c.mozilla.SiteMap.tip.fadeTimer=setTimeout(function(){clearTimeout(c.mozilla.SiteMap.tip.fadeTimer);c.mozilla.SiteMap.tip.fadeTimer=null;c.mozilla.SiteMap.hideTip();},c.mozilla.SiteMap.TIP_FADE_PERIOD);});},initLocation:function(){var f=location.hash;var g=(f.substring(0,1)=="#")?f.substring(1):f;if(g){var e=c.mozilla.SiteMap.hypertree.graph.getNode(g);if(e){c.mozilla.SiteMap.hypertree.fx.config.duration=0;c.mozilla.SiteMap.selectNode(e);c.mozilla.SiteMap.hypertree.fx.config.duration=c.mozilla.SiteMap.MOVE_PERIOD;}}setInterval(function(){c.mozilla.SiteMap.updateLocation();},c.mozilla.SiteMap.LOCATION_INTERVAL*1000);},updateLocation:function(){var f=c.mozilla.SiteMap.selectedNode.id;var g=location.hash;var h=(g.substring(0,1)=="#")?g.substring(1):g;if(!h){h=c.mozilla.SiteMap.rootNode.id;}if(h!==f){var e=c.mozilla.SiteMap.hypertree.graph.getNode(h);if(e){c.mozilla.SiteMap.hypertree.fx.config.duration=Math.floor(c.mozilla.SiteMap.MOVE_PERIOD/2);c.mozilla.SiteMap.selectNode(e);c.mozilla.SiteMap.hypertree.fx.config.duration=c.mozilla.SiteMap.MOVE_PERIOD;}}},_init:function(e){c.mozilla.SiteMap.dataUrl=e;c.mozilla.SiteMap.defaultTip=c.mozilla.SiteMap.$panel.html();c.mozilla.SiteMap.$graph.bind("cm:data:ready",function(){c.mozilla.SiteMap.loadGraph();c.mozilla.SiteMap.initLocation();});c.mozilla.SiteMap.$graph.bind("cm:reset",c.mozilla.SiteMap.reset);c.mozilla.SiteMap.initPanel();c.mozilla.SiteMap.reset();c.mozilla.SiteMap.loadData();}};c.mozilla.SiteMap._init(a.dataUrl);if(typeof d!="undefined"){d();}};